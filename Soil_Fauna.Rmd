---
title: "Soil Fauna"
description: |
  Tullgren Extraction of Soil Meso and Macro Fauna
output:
    distill::distill_article:
      toc: true
      toc_depth: 3
---

![](media/gallery/Cricket.jpg)


Soil invertebrates are incredibly diverse. To put things in perspective: Perching birds (this includes more than half of all bird species worldwide) are in the single order Passeriformes. A single soil sample from a mature forest can contain more than twenty different *orders* of animals! Most soil organisms in the tropics are undescribed species - if you look at a sample under the microscope you are likely to be the first human to ever lay eyes on at least a few species. These tiny creature also play a critical role in the carbon cycle, contributing to decomposition of plant material and cycling nutrients in the soil.


Important for the context of holistic biodiversity monitoring, soil fauna are very location-specific. A mammal observation at a particular point does not necessarily give too much information about the quality of habitat at that point for the mammal - the mammal could just be passing through between places that it actually eats, sleeps and mates. On the other hand, soil fauna have vastly smaller home ranges, and in all likelihood spend their entire lives within a few meters of the sampling point. So, in a patchy landscape with a lot of disturbance they are better indicators of conditions at a particular sampling point.


Brief summary of what I will be doing with my soil invert data:

- Clean up and prepare for vegan R package

- Calculate invertebrate richness at each sampling point, as well as abundance of all taxa across points and land use types

- Calculate Shannon, Simpson and other diversity indices for each land use type

- Run some ordinations to look at community composition differences between land use types.

- Visualize abundance for all orders in relation to land use to see which are most sensitive. 

- If I have enough temperature data from this first round of sampling see if temperature mediates invertebrate response to land use (I suspect it does). The moisture data is unfortunately pretty low resolution, but that probably also plays a very important role. 


### Data cleanup 

Here is a .csv file with raw data for the invert pilot study:

```{r echo=FALSE}
xfun::embed_file('media/working directory/data/Soil invert data.csv')
```  



This spreadsheet is a combination of the invertebrate abundance data and the collection/extraction metadata, in long format. I will start with some clean up and organization. This involves making sure that R reads my dates as dates, converting my data to long format, splitting the dataset in two (one with unknowns and one without), correcting abundance data for sample mass, and splitting the data into absolute and relative abundance. I use absolute abundance data for calculating diversity indices and relative abundance for community structure modelling. 

<details markdown="1">
<summary><strong>Click here</strong> for code </summary>

```{r setup, message=FALSE, results = 'hide'}

data <- read.csv('media/working directory/data/soil invert data.csv')

#load packages

library(ggplot2)
library(tidyr)
library(dplyr)
library(gridExtra)
library('funrar')
library(lubridate)
library(viridis)

## Initial cleanup, organization

#make dates recognizable by R
data$collect.date <- ymd(data$collect.date)

#Add 0 abundance for unobserved taxa
data$count[is.na(data$count)] <- 0

#remove excess rows from dataframe
data<-data[which(complete.cases(data$collect.date)),]

#create dataset with unknowns (for total abundance)
data.unknown<-data

#create dataset without unknowns (for diversity and community composition)
data <- subset(data, !taxon == "Unknown",)

#make my data wide for vegan package
wide.data <- data %>%
  pivot_wider(names_from = taxon, values_from = count)

#make same wide dataframe for data with unknowns
wide.data.unknown <- data.unknown %>%
  pivot_wider(names_from = taxon, values_from = count)

#Splitting data frame into count and environmental data
wide.data2<-wide.data[,-c(1:12)]     
wide.data3<-wide.data[,-c(13:66)]
wide.data.unknown2<-wide.data.unknown[,-c(1:12)]
wide.data.unknown3<-wide.data.unknown[,-c(13:67)]

# Converting to count per dry mass

#converting to count/1000g
wide.data2 <- (1000/wide.data3$dry.mass)*wide.data2
wide.data.unknown2 <- (1000/wide.data.unknown3$dry.mass)*wide.data.unknown2

#Next I convert mass-corrected absolute abundance to relative abundance, which is used later for total abundance, individual taxon abundance, and community structure modelling. 

#Before the conversion I create data frames backing up the mass-corrected absolute count data for diversity index calculations. 

#Creating versions of the count data that are corrected for mass, but not made relative (for diversity indexes)
wide.data.absolute <- wide.data2
wide.data.unknown.absolute <- wide.data.unknown2

#reincorporating, and duplicating mass-corrected absolute count data (only doing it for unknowns because this data frame will be used for abundance)
wide.data.unknown[,c(13:67)] <- wide.data.unknown.absolute
wide.data.unknown.absolute2 <- wide.data.unknown

#converting absolute to relative abundance
wide.data2 <- as.matrix(wide.data2)
wide.data.unknown2 <- as.matrix(wide.data.unknown2)
wide.data2 <- make_relative(wide.data2)
wide.data.unknown2 <- make_relative(wide.data.unknown2)
wide.data2 <- as.data.frame(wide.data2)
wide.data.unknown2 <- as.data.frame(wide.data.unknown2)

#reincorporating mass-corrected relative count data into original data frame
wide.data[,c(13:66)] <- wide.data2
wide.data.unknown[,c(13:67)] <- wide.data.unknown2

```

</details>


Next up I'll calculate richness, evenness, total abundance, and several diversity indices using the ['vegan'](https://cran.r-project.org/web/packages/vegan/index.html) R package. I use absolute abundance to calculate these metrics.


<details markdown="1">
<summary><strong>Click here</strong> for code </summary>
```{r, message=FALSE, results = 'hide'}
library(vegan)

taxa <- specnumber(wide.data.absolute)                  #Tallying number of taxa
shannon<-diversity(wide.data.absolute)                  #Shannon diversity index
simpson<- diversity(wide.data.absolute, "simpson")      #Simpson diversity index
J<-shannon/log(taxa)                                    #Pielou's evenness
abundance<-rowSums(wide.data.unknown.absolute)          #total absolute abundance per 1000g (including unknowns)

data.summary<-data.frame(wide.data3,taxa, abundance, J, shannon, simpson)

diversity.indices <- data.summary[,c(1:2,13:17)]

```
</details>

Here's what that data looks like:

```{r, echo=FALSE}
knitr::kable(diversity.indices[1:10, ], format = "markdown")

```

Taxa is the number of unique taxa found in each sample (richness/alpha diversity), abundance is total (mass-corrected) abundance of soil fauna, J is Pielou's evenness (how evenly distributed abundance is between the taxa; species dominance rather than diversity), and Shannon and Simpson are two different diversity indices, ways of conceptualizing diversity that combine abundance and richness. The Simpson index is more heavily influenced by dominant species, while the Shannon index is more heavily influenced by rare species. Going forward I will use Shannon to represent diversity, but if we want we can easily swap in Simpson or something else. Note: sample 53 is anomalous. Never have I seen a mature forest sample with so few inverts. Maybe the reason will become apparent after soil chemistry analysis, or there was an error of some kind during extraction/sample processing.

Let's summarize averages for each land use type:

```{r, echo=FALSE}
subset.mature <- subset(data.summary, land.use == "mature")
subset.nat.regen <- subset(data.summary, land.use == "nat.regen")
subset.reforestation <- subset(data.summary, land.use == "reforestation")
subset.teak <- subset(data.summary, land.use == "teak")
subset.pasture <- subset(data.summary, land.use == "pasture")


land.use <- c('mature', 'nat.regen', 'reforestation', 'teak', 'pasture')
taxa <- c(mean(subset.mature$taxa),
          mean(subset.nat.regen$taxa), 
          mean(subset.reforestation$taxa),      
          mean(subset.teak$taxa),
          mean(subset.pasture$taxa))
abundance <- c(mean(subset.mature$abundance),
          mean(subset.nat.regen$abundance), 
          mean(subset.reforestation$abundance),      
          mean(subset.teak$abundance),
          mean(subset.pasture$abundance))
J <- c(mean(subset.mature$J),
          mean(subset.nat.regen$J), 
          mean(subset.reforestation$J),      
          mean(subset.teak$J),
          mean(subset.pasture$J))
shannon <- c(mean(subset.mature$shannon),
          mean(subset.nat.regen$shannon), 
          mean(subset.reforestation$shannon),      
          mean(subset.teak$shannon),
          mean(subset.pasture$shannon))
simpson <- c(mean(subset.mature$simpson),
          mean(subset.nat.regen$simpson), 
          mean(subset.reforestation$simpson),      
          mean(subset.teak$simpson),
          mean(subset.pasture$simpson))

mean.values <- data.frame(land.use, taxa, abundance, J, shannon, simpson)

knitr::kable(mean.values, format = "markdown")
```
Now let's visualize it.


### Total abundance 

```{r, echo=FALSE, message = FALSE, warning = FALSE}

##### Abundance
ggplot(data=mean.values, aes(x=land.use, y=abundance, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), aes(x = factor(land.use, level = land.use)), width = .5, show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Total abundance of soil fauna", x="Land Use Type", y = "Mean abundance (count/1kg dry soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5))
```

Abundance data is corrected for mass to give values of density per 1000g dry soil. The soil moisture values are based on air-dried samples and mass was recorded with a kitchen scale (low resolution), so moisture is a potential source of error here.

Moisture has a large influence on mass, and can vary considerably (30-50% in the wet season in my experience), so this is a considerable source of error.


### Taxonomic Richness

```{r, echo=FALSE, message = FALSE, warning = FALSE}

##### Richness
ggplot(data=mean.values, aes(x=land.use, y=taxa, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), aes(x = factor(land.use, level = land.use)), width = .5, show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Taxonomic richness of soil fauna", x="Land Use Type", y = "Ordinal taxonomic richness")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5))
```


The low richness in teak is perhaps related to nutrient leaching and soil erosion ([FernÃ¡ndez-Moya et al 2014](https://www.sciencedirect.com/science/article/abs/pii/S0341816214002379), [Amponsah & Meyer 2008](https://www.tandfonline.com/doi/abs/10.1080/00103620009370442), [Boley et al 2009](https://www.sciencedirect.com/science/article/abs/pii/S0378112709001534)). Assessing biodiversity via richness has the caveat that rare species weigh pretty heavily on the metric. If a community has 100 individuals of one taxon but only one individual each for a further 9, then it will have a higher richness than a community composed of 8 taxa with 1 individuals each (a more diverse scenario).

### Shannon Diversity


```{r, echo=FALSE, message = FALSE, warning = FALSE}

##### Shannon diversity
ggplot(data=mean.values, aes(x=land.use, y=shannon, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), aes(x = factor(land.use, level = land.use)), width = .5, show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Shannon diversity of soil fauna", x="Land Use Type", y = "Shannon index")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5))
```

### Everything again excluding AZSOIL053

These results are somewhat surprising - Mature forest had the greatest abundance and richness in my pilot study. As of 1.7.24 these results are based only on 25 sampling points, once I get the data for the remainder the story will be more complete. I also wonder if sample 53 is single-handedly skewing these results right now?

Let's redo everything excluding sample 53:

```{r, echo=FALSE, message = FALSE, warning = FALSE}
subset.mature53 <- subset.mature[-c(1), ] 

taxa53 <- c(mean(subset.mature53$taxa),
          mean(subset.nat.regen$taxa), 
          mean(subset.reforestation$taxa),      
          mean(subset.teak$taxa),
          mean(subset.pasture$taxa))
abundance53 <- c(mean(subset.mature53$abundance),
          mean(subset.nat.regen$abundance), 
          mean(subset.reforestation$abundance),      
          mean(subset.teak$abundance),
          mean(subset.pasture$abundance))
J53 <- c(mean(subset.mature53$J),
          mean(subset.nat.regen$J), 
          mean(subset.reforestation$J),      
          mean(subset.teak$J),
          mean(subset.pasture$J))
shannon53 <- c(mean(subset.mature53$shannon),
          mean(subset.nat.regen$shannon), 
          mean(subset.reforestation$shannon),      
          mean(subset.teak$shannon),
          mean(subset.pasture$shannon))
simpson53 <- c(mean(subset.mature53$simpson),
          mean(subset.nat.regen$simpson), 
          mean(subset.reforestation$simpson),      
          mean(subset.teak$simpson),
          mean(subset.pasture$simpson))

mean.values53 <- data.frame(land.use, taxa53, abundance53, J53, shannon53, simpson53)

##### Abundance
ggplot(data=mean.values53, aes(x=land.use, y=abundance53, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), aes(x = factor(land.use, level = land.use)), width = .5, show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Total abundance of soil fauna", x="Land Use Type", y = "Mean abundance (count/1kg dry soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5))

ggplot(data=mean.values53, aes(x=land.use, y=taxa53, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), aes(x = factor(land.use, level = land.use)), width = .5, show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Taxonomic richness of soil fauna", x="Land Use Type", y = "Ordinal taxonomic richness")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5))

ggplot(data=mean.values53, aes(x=land.use, y=shannon53, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), aes(x = factor(land.use, level = land.use)), width = .5, show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Shannon diversity of soil fauna", x="Land Use Type", y = "Shannon index")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5))
```

Interesting. Mature forest still lags behind natural regeneration.

### Significance

Let's run some ANOVAs

```{r, message = FALSE, warning = FALSE}

### Richness
anova.soil.taxa <- aov(taxa ~ land.use, data = data.summary)
summary(anova.soil.taxa)

### Abundance
anova.soil.abundance <- aov(abundance ~ land.use, data = data.summary)
summary(anova.soil.abundance)

### Soil diversity
anova.soil.diversity <- aov(shannon ~ land.use, data = data.summary)
summary(anova.soil.diversity)
```

### Individual taxa abundance

Now going into the weeds a bit, let's see how land use affects diferent taxa. During my pilot testing some groups stood out as especially sensitive to land use, lets see if that holds.

Very unfortunately my soil temperature/moisture probe didn't work, and the new temperature probe I ordered broke shortly after starting soil collections. Consequently, soil moisture data is based on air dried samples weighed with a low-precision scale, and soil temperature values are only available for some of the samples. This is especially unfortunate because I strongly suspect that soil moisture and temperature mediate the effect of land use on soil invertebrates. Mature forests with a full canopy are likely to have more stable temperatures, lower daytime temperatures, and higher soil moisture than young forests or pastureland. Furthermore,the taxa that I found to be most sensitive to temperature during my research on BCI were most sensitive to land use in Azuero.

<details markdown="1">
<summary><strong>Click here</strong> for setup code </summary>

```{r, echo=FALSE, message = FALSE, warning = FALSE}
#some setup:

#Absolute abundance:
#first splitting the data by land use type
mature.data <- wide.data.unknown.absolute2[wide.data.unknown.absolute2$land.use=="mature",]
nat.regen.data <- wide.data.unknown.absolute2[wide.data.unknown.absolute2$land.use=="nat.regen",]
reforestation.data <- wide.data.unknown.absolute2[wide.data.unknown.absolute2$land.use=="reforestation",]
teak.data <- wide.data.unknown.absolute2[wide.data.unknown.absolute2$land.use=="teak",]
pasture.data <- wide.data.unknown.absolute2[wide.data.unknown.absolute2$land.use=="pasture",]

#Then finding the mean abundance for each taxa, for each land use
mean.abundance.mature <- summarize_all(mature.data, mean)
mean.abundance.nat.regen <- summarize_all(nat.regen.data, mean)
mean.abundance.reforestation <- summarize_all(reforestation.data, mean)
mean.abundance.teak <- summarize_all(teak.data, mean)
mean.abundance.pasture <- summarize_all(pasture.data, mean)

#Reincorporating the land use data
mean.abundance.mature$land.use <- "mature"
mean.abundance.nat.regen$land.use <- "nat.regen"
mean.abundance.reforestation$land.use <- "reforestation"
mean.abundance.teak$land.use <- "teak"
mean.abundance.pasture$land.use <- "pasture"

#finally I make a dataframe with average abundance data for each land use type.
mean.abundance.summary <- rbind(mean.abundance.mature, 
                                    mean.abundance.nat.regen,
                                    mean.abundance.reforestation,
                                    mean.abundance.teak,
                                    mean.abundance.pasture)
#cut out the columns that got lost along the way
mean.abundance.summary <- mean.abundance.summary[-c(1,3:7,12)]

##repeat everything for relative abundance:
#first splitting the data by land use type
mature.dataR <- wide.data.unknown[wide.data.unknown$land.use=="mature",]
nat.regen.dataR <- wide.data.unknown[wide.data.unknown$land.use=="nat.regen",]
reforestation.dataR <- wide.data.unknown[wide.data.unknown$land.use=="reforestation",]
teak.dataR <- wide.data.unknown[wide.data.unknown$land.use=="teak",]
pasture.dataR <- wide.data.unknown[wide.data.unknown$land.use=="pasture",]

#Then finding the mean abundance for each taxa, for each land use
mean.abundance.matureR <- summarize_all(mature.dataR, mean)
mean.abundance.nat.regenR <- summarize_all(nat.regen.dataR, mean)
mean.abundance.reforestationR <- summarize_all(reforestation.dataR, mean)
mean.abundance.teakR <- summarize_all(teak.dataR, mean)
mean.abundance.pastureR <- summarize_all(pasture.dataR, mean)

#Reincorporating the land use data
mean.abundance.matureR$land.use <- "mature"
mean.abundance.nat.regenR$land.use <- "nat.regen"
mean.abundance.reforestationR$land.use <- "reforestation"
mean.abundance.teakR$land.use <- "teak"
mean.abundance.pastureR$land.use <- "pasture"

#finally I make a dataframe with average abundance data for each land use type.
mean.abundance.summaryR <- rbind(mean.abundance.matureR, 
                                    mean.abundance.nat.regenR,
                                    mean.abundance.reforestationR,
                                    mean.abundance.teakR,
                                    mean.abundance.pastureR)
#cut out the columns that got lost along the way
mean.abundance.summaryR <- mean.abundance.summaryR[-c(1,3:7,12)]
```

</details>

### Formicidae [Hymenoptera]
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### Hymenoptera absolute
hym.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Formicidae, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Formicidae absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))

##### Formicidae relative
hym.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Formicidae, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Formicidae relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(hym.ab, hym.rel, ncol=2, widths = c(1.65,2))
```

### Coleoptera
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### Coleoptera absolute
col.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Coleoptera, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Coleoptera absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))

##### Coleoptera relative
col.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Coleoptera, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Coleoptera relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(col.ab, col.rel, ncol=2, widths = c(1.65,2))
```

### Geococcus [Hemiptera]
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### Geococcus absolute
hem.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Geococcus, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Geococcus absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))


##### Geococcus relative
hem.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Geococcus, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Geococcus relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(hem.ab, hem.rel, ncol=2, widths = c(1.65,2))
```

### Protura
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### Protura absolute
pro.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Protura, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Protura absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))

##### Protura relative
pro.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Protura, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Protura relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(pro.ab, pro.rel, ncol=2, widths = c(1.65,2))
```

### Collembola
```{r, echo=FALSE, message = FALSE, warning = FALSE}
mean.abundance.summaryR$Collembola <- mean.abundance.summaryR$Entomobryomorpha + mean.abundance.summaryR$Poduromorpha + mean.abundance.summaryR$Symphypleona
mean.abundance.summary$Collembola <- mean.abundance.summary$Entomobryomorpha + mean.abundance.summary$Poduromorpha + mean.abundance.summary$Symphypleona

##### Collembola absolute
coll.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Collembola, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Collembola absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))

##### Collembola relative
coll.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Collembola, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Collembola relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(coll.ab, coll.rel, ncol=2, widths = c(1.65,2)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

```

### Oribatida
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### Oribatida absolute
ori.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Oribatida, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Oribatida absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))

##### Oribatida relative
ori.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Oribatida, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Oribatida relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(ori.ab, ori.rel, ncol=2, widths = c(1.65,2))
```

### Other Acari
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### other.acari absolute
aca.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=acari.other, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Other Acari absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))


##### other.acari relative
aca.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=acari.other, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="other.acari relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(aca.ab, aca.rel, ncol=2, widths = c(1.65,2))
```

### Pseudoscorpiones
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### Pseudoscorpiones absolute
pse.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Pseudoscorpiones, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Pseudoscorpiones absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))


##### Pseudoscorpiones relative
pse.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Pseudoscorpiones, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Pseudoscorpiones relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(pse.ab, pse.rel, ncol=2, widths = c(1.65,2))
```

### Diplura
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### Diplura absolute
dip.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Diplura, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Diplura absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))

##### Diplura relative
dip.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Diplura, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Diplura relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(dip.ab, dip.rel, ncol=2, widths = c(1.65,2))
```

### Symphyla
```{r, echo=FALSE, message = FALSE, warning = FALSE}
##### Symphyla absolute
sym.ab <- ggplot(data=mean.abundance.summary, aes(x=land.use, y=Symphyla, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Symphyla absolute", 
       x="Land Use Type", y = "Abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position="none") + scale_x_discrete(guide = guide_axis(n.dodge = 2))


##### Symphyla relative
sym.rel <- ggplot(data=mean.abundance.summaryR, aes(x=land.use, y=Symphyla, fill=land.use)) +
  geom_bar(stat="identity", position=position_dodge(), width = 0.50, aes(x = factor(land.use, level = land.use)), show.legend = FALSE)+
  #scale_fill_brewer(palette="Paired")+ 
  labs(title="Symphyla relative", 
       x="Land Use Type", y = "Relative abundance (count/1kg soil)")+
  theme(text=element_text(family="Arial")) + 
  scale_fill_viridis(discrete=TRUE, option="viridis", begin = .3,end = .75,)+
  theme_minimal()+ theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(guide = guide_axis(n.dodge = 2))

grid.arrange(sym.ab, sym.rel, ncol=2, widths = c(1.65,2))

```